âœ¨ Storage Service - ä½¿ç”¨æé†’
===================================

ğŸ¯ é‡è¦æé†’
-----------

æ­¤é …ç›®å·²å¯¦ç¾çµ±ä¸€çš„æ•¸æ“šæŒä¹…åŒ–æœå‹™ï¼

**ä¸è¦å¿˜è¨˜ä½¿ç”¨å®ƒï¼Œè€Œæ˜¯è‡ªå·±å¯¦ç¾å­˜å„²é‚è¼¯ã€‚**

ğŸš€ å¿«é€Ÿé–‹å§‹ (30 ç§’)
-------------------

```typescript
import { getStorageService } from "@/lib/storage-service";

const storage = getStorageService();

// ä¿å­˜
await storage.saveSession({
  appState: { lastOpenedMdiPath: "/path/to/file.mdi" },
  recentFiles: [],
  editorBuffer: { content: "...", timestamp: Date.now() }
});

// åŠ è¼‰
const session = await storage.loadSession();
```

å°±é€™éº¼ç°¡å–®ï¼è‡ªå‹•åœ¨ Electron å’Œ Web ä¸­å·¥ä½œã€‚

ğŸ“š æ–‡æª”ä½ç½®
-----------

å¿«é€Ÿå°èˆª:          STORAGE_INDEX.md
é›†æˆæŒ‡å—:          ELECTRON_INTEGRATION_CHECKLIST.md
API æŸ¥è©¢:          STORAGE_QUICK_REFERENCE.md
æ¶æ§‹è©³è§£:          STORAGE_ARCHITECTURE.md
ä»£ç¢¼ç¤ºä¾‹:          lib/storage-service-examples.ts

ğŸ“ æ ¸å¿ƒä½ç½®
-----------

å¯¦ç¾:  lib/storage-*.ts
è¦å‰‡:  .cursor/rules/storage-service.md

ğŸ“ 12 å€‹æ ¸å¿ƒæ–¹æ³•
-----------------

æœƒè©±:  saveSession(), loadSession()
ç‹€æ…‹:  saveAppState(), loadAppState()
æ–‡ä»¶:  addToRecent(), getRecentFiles(), removeFromRecent(), clearRecent()
è‰ç¨¿:  saveEditorBuffer(), loadEditorBuffer(), clearEditorBuffer()
æ¸…é™¤:  clearAll()

âœ… ä½•æ™‚ä½¿ç”¨
-----------

âœ“ ä¿å­˜æ‡‰ç”¨ç‹€æ…‹
âœ“ åŠ è¼‰å…ˆå‰çš„æœƒè©±
âœ“ ç®¡ç†æœ€è¿‘ä½¿ç”¨çš„æª”æ¡ˆ
âœ“ è‡ªå‹•ä¿å­˜è‰ç¨¿
âœ“ å´©æ½°æ¢å¾©
âœ“ ä»»ä½•éœ€è¦æŒä¹…åŒ–çš„æ•¸æ“š

âŒ ä½•æ™‚ä¸ç”¨
-----------

âœ— ä¸è¦è‡ªå·±å¯¦ç¾å­˜å„²é‚è¼¯
âœ— ä¸è¦ç›´æ¥ä½¿ç”¨ localStorage
âœ— ä¸è¦æ‰‹å‹•æ“ä½œ IndexedDB
âœ— ä¸è¦ç›´æ¥è¨ªå• SQLite

ğŸ”‘ é—œéµç‰¹æ€§
-----------

âœ¨ çµ±ä¸€ API     - åŒä¸€ä»£ç¢¼æ”¯æŒ Electron å’Œ Web
âœ¨ è‡ªå‹•æª¢æ¸¬     - ç„¡éœ€æ‰‹å‹•é…ç½®ç’°å¢ƒ
âœ¨ é«˜æ•ˆèƒ½       - Electron åŒæ­¥ï¼ŒWeb ç•°æ­¥
âœ¨ é¡å‹å®‰å…¨     - å®Œæ•´ TypeScript æ”¯æ´
âœ¨ æ˜“æ–¼ä½¿ç”¨     - ç°¡å–®ç›´è§€çš„ API

âš¡ æ€§èƒ½æç¤º
-----------

â€¢ æœ€è¿‘æ–‡ä»¶è‡ªå‹•é™åˆ¶ 10 é …
â€¢ ç·¨è¼¯ç·©è¡å€æ¯ 30 ç§’ä¿å­˜ä¸€æ¬¡
â€¢ ä½¿ç”¨ saveSession() æ‰¹é‡æ“ä½œ
â€¢ Electron: ~2-5ms, Web: ~10-20ms

ğŸ“ å¿«é€Ÿå¹«åŠ©
-----------

è¨­ç½®è‡ªå‹•ä¿å­˜:
  setInterval(() => storage.saveEditorBuffer(...), 30000)

æ‡‰ç”¨å•Ÿå‹•æ¢å¾©:
  const session = await storage.loadSession()

ä¿å­˜æ™‚æ›´æ–°:
  await storage.addToRecent({...})
  await storage.saveAppState({...})
  await storage.clearEditorBuffer()

æ¸¬è©¦:
  import { StorageServiceTestSuite } from "@/lib/storage-service-tests"
  await new StorageServiceTestSuite().runAll()

â“ å¸¸è¦‹å•é¡Œ
-----------

Q: éœ€è¦æ‰‹å‹• initialize() å—?
A: ä¸éœ€è¦ï¼Œè‡ªå‹•èª¿ç”¨ã€‚

Q: åœ¨ Web ä¸­éœ€è¦é…ç½®å—?
A: ä¸éœ€è¦ï¼Œç›´æ¥ä½¿ç”¨ã€‚

Q: åœ¨ Electron ä¸­éœ€è¦ä»€éº¼?
A: éœ€è¦åœ¨ main.ts å’Œ preload.ts ä¸­æ·»åŠ  IPC è™•ç†å™¨
   åƒè€ƒ: ELECTRON_INTEGRATION_CHECKLIST.md

Q: æ•¸æ“šå­˜å„²åœ¨å“ªè£¡?
A: Electron: ~/Library/Application Support/Illusions/illusions-storage.db
   Web: ç€è¦½å™¨ IndexedDB

Q: èƒ½å¦è‡ªè¨‚æœ€è¿‘æ–‡ä»¶æ•¸é‡?
A: å¯ä»¥ï¼Œç·¨è¼¯å¯¦ä½œä¸­çš„å¸¸æ•¸ã€‚

ç‰ˆæœ¬: 1.0.0 | ç‹€æ…‹: âœ… ç”Ÿç”¢å°±ç·’
æ›´æ–°: 2026-01-28

ğŸ‘‰ ç«‹å³é–‹å§‹: é–±è®€ STORAGE_INDEX.md
