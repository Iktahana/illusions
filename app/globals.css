/* Local fonts are loaded conditionally - see lib/fonts.ts */
/* If local font files don't exist, Google Fonts will be used as fallback */

/* Japanese novel plugin styles (vertical, manuscript, ruby, tcy) */
@import '../packages/milkdown-plugin-japanese-novel/styles/index.css';

@tailwind base;
@tailwind components;
@tailwind utilities;

/* Prevent flash of white on initial load - default to dark theme */
html {
  background-color: #0a0a0a;
  color-scheme: dark;
}

:root {
  /* Background colors (RGB channels for Tailwind opacity support) */
  --background: 255 255 255;
  --background-secondary: 248 250 252;
  --background-tertiary: 241 245 249;
  --background-elevated: 255 255 255;

  /* Text colors */
  --foreground: 15 23 42;
  --foreground-secondary: 71 85 105;
  --foreground-tertiary: 100 116 139;
  --foreground-muted: 148 163 184;

  /* Border colors */
  --border: 226 232 240;
  --border-secondary: 203 213 225;

  /* Accent colors */
  --accent: 99 102 241;
  --accent-foreground: 255 255 255;
  --accent-light: 238 242 255;
  --accent-hover: 79 70 229;

  /* Interactive states */
  --hover: 241 245 249;
  --active: 224 231 255;

  /* Status colors */
  --success: 16 185 129;
  --warning: 245 158 11;
  --error: 239 68 68;
  --info: 59 130 246;
  
  /* Progress bar colors for light mode */
  --progress-readability: #6366f1;
  --progress-kanji: #ef4444;
  --progress-hiragana: #3b82f6;
  --progress-katakana: #10b981;
  --progress-other: #71717a;
  
  /* Part-of-Speech (品詞) highlighting colors */
  --pos-verb: #22c55e;
  --pos-verb-intransitive: #16a34a;
  --pos-verb-transitive: #4ade80;
  --pos-particle: #a855f7;
  --pos-auxiliary: #8b5cf6;
  --pos-adjective: #3b82f6;
  --pos-adverb: #f97316;
  --pos-conjunction: #14b8a6;
  --pos-interjection: #ec4899;
  --pos-adnominal: #6366f1;
  --pos-noun: inherit;
}

.dark {
  /* Background colors - darker for better contrast (RGB channels) */
  --background: 10 10 10;
  --background-secondary: 26 26 26;
  --background-tertiary: 42 42 42;
  --background-elevated: 26 26 26;

  /* Text colors - brighter for better contrast */
  --foreground: 255 255 255;
  --foreground-secondary: 229 229 229;
  --foreground-tertiary: 179 179 179;
  --foreground-muted: 128 128 128;

  /* Border colors - more visible */
  --border: 51 51 51;
  --border-secondary: 64 64 64;

  /* Accent colors - brighter and more vibrant */
  --accent: 129 140 248;
  --accent-foreground: 255 255 255;
  --accent-light: 67 56 202;
  --accent-hover: 99 102 241;

  /* Interactive states */
  --hover: 31 31 31;
  --active: 67 56 202;

   /* Status colors - brighter for better visibility */
   --success: 52 211 153;
   --warning: 251 191 36;
   --error: 248 113 113;
   --info: 96 165 250;
   
   /* Progress bar colors for dark mode */
   --progress-readability: #818cf8;
   --progress-kanji: #f87171;
   --progress-hiragana: #60a5fa;
   --progress-katakana: #34d399;
   --progress-other: #a1a1aa;
   
   /* Part-of-Speech highlighting colors - dark mode (slightly brighter) */
   --pos-verb: #4ade80;
   --pos-verb-intransitive: #22c55e;
   --pos-verb-transitive: #86efac;
   --pos-particle: #c084fc;
   --pos-auxiliary: #a78bfa;
   --pos-adjective: #60a5fa;
   --pos-adverb: #fb923c;
   --pos-conjunction: #2dd4bf;
   --pos-interjection: #f472b6;
   --pos-adnominal: #818cf8;
   --pos-noun: inherit;
}

body {
  color: rgb(var(--foreground));
  background: rgb(var(--background));
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
  transition: background-color 0s, color 0s; /* Prevent transition flash */
}

/* Override default background after theme is determined */
html:not(.dark) {
  background-color: #ffffff;
  color-scheme: light;
}

@layer utilities {
  .text-balance {
    text-wrap: balance;
  }
}

/* Linting decoration styles (wavy underlines by severity) */
.lint-error {
  text-decoration: wavy underline;
  text-decoration-color: rgb(var(--error));
  text-underline-offset: 3px;
  text-decoration-thickness: 1.5px;
}

.lint-warning {
  text-decoration: wavy underline;
  text-decoration-color: rgb(var(--warning));
  text-underline-offset: 3px;
  text-decoration-thickness: 1.5px;
}

.lint-info {
  text-decoration: wavy underline;
  text-decoration-color: rgb(var(--info));
  text-underline-offset: 3px;
  text-decoration-thickness: 1.5px;
}

@keyframes fade-out {
  0%, 70% { opacity: 1; }
  100% { opacity: 0; }
}

.animate-fade-out {
  animation: fade-out 2s ease-out forwards;
}

/* Notification banner animations */
@keyframes slide-in-down {
  from {
    transform: translateY(-100%);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

@keyframes slide-out-up {
  from {
    transform: translateY(0);
    opacity: 1;
  }
  to {
    transform: translateY(-100%);
    opacity: 0;
  }
}

@keyframes pulse-glow {
  0%, 100% {
    box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.7);
  }
  50% {
    box-shadow: 0 0 0 6px rgba(16, 185, 129, 0);
  }
}

.animate-slide-in-down {
  animation: slide-in-down 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.animate-slide-out-up {
  animation: slide-out-up 0.3s cubic-bezier(0.4, 0, 1, 0.2);
}

.animate-pulse-glow {
  animation: pulse-glow 2s infinite;
}

/* Save success toast animation */
@keyframes save-toast-in {
  0% {
    opacity: 0;
    transform: translateY(8px) scale(0.95);
  }
  100% {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

@keyframes save-toast-out {
  0% {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
  100% {
    opacity: 0;
    transform: translateY(-8px) scale(0.95);
  }
}

.animate-save-toast-in {
  animation: save-toast-in 0.2s ease-out forwards;
}

.animate-save-toast-out {
  animation: save-toast-out 0.15s ease-in forwards;
}

/* Milkdown editor custom styles */
.milkdown {
  @apply bg-transparent text-foreground;
}

.milkdown .editor {
  @apply outline-none min-h-full;
}

.milkdown p {
  margin-bottom: 0.5em;
}

/* List styles */
.milkdown ul,
.milkdown ol {
  margin: 0.5em 0;
  padding-left: 2em;
}

.milkdown ul {
  list-style-type: disc;
}

.milkdown ol {
  list-style-type: decimal;
}

.milkdown li {
  margin: 0.25em 0;
}

.milkdown ul ul {
  list-style-type: circle;
}

.milkdown ul ul ul {
  list-style-type: square;
}

.milkdown ol ol {
  list-style-type: lower-alpha;
}

.milkdown ol ol ol {
  list-style-type: lower-roman;
}

/* Blockquote styles */
.milkdown blockquote {
  margin: 0.5em 0;
  padding-left: 1em;
  border-left: 3px solid rgb(var(--border-secondary));
  color: rgb(var(--foreground-secondary));
}

.milkdown h1 {
  font-size: 2em;
  font-weight: bold;
  margin-bottom: 0.5em;
}

.milkdown h2 {
  font-size: 1.5em;
  font-weight: bold;
  margin-bottom: 0.4em;
}

.milkdown h3 {
  font-size: 1.25em;
  font-weight: bold;
  margin-bottom: 0.3em;
}

.milkdown h4 {
  font-size: 1.1em;
  font-weight: bold;
  margin-bottom: 0.25em;
}

.milkdown h5 {
  font-size: 1em;
  font-weight: bold;
  margin-bottom: 0.2em;
}

.milkdown h6 {
  font-size: 0.9em;
  font-weight: bold;
  margin-bottom: 0.2em;
}

.milkdown h1,
.milkdown h2,
.milkdown h3,
.milkdown h4,
.milkdown h5,
.milkdown h6 {
  position: relative;
}

/* Font preview select styling */
.font-preview-select option {
  padding: 8px;
  font-size: 14px;
}

.font-preview-select optgroup {
  font-weight: 600;
  color: rgb(var(--foreground-tertiary));
  background: rgb(var(--background-tertiary));
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
}

/* Scrollbar styling */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  @apply bg-background-tertiary;
}

::-webkit-scrollbar-thumb {
  @apply bg-border-secondary rounded;
}

::-webkit-scrollbar-thumb:hover {
  @apply bg-border;
}

/* Statistics section header styles */
.stats-header {
  position: relative;
  display: inline-block;
  font-size: 0.875rem;
  font-weight: 500;
  color: rgb(var(--foreground-secondary));
}


/* Tooltip styles for info icons */
.info-tooltip-wrapper {
  position: relative;
  display: inline-flex;
  align-items: center;
}

/* Statistics panel text opacity */
.stats-panel {
  --stats-text: rgb(var(--foreground) / 0.8);
}

.stats-panel,
.stats-panel * {
  color: var(--stats-text) !important;
}


.info-tooltip-content {
  position: fixed;
  padding: 8px 12px;
  background: rgb(var(--background-elevated));
  border: 1px solid rgb(var(--border));
  border-radius: 6px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  font-size: 12px;
  line-height: 1.5;
  color: rgb(var(--foreground));
  max-width: 320px;
  min-width: 200px;
  white-space: pre-line;
  overflow-wrap: anywhere;
  word-break: break-word;
  pointer-events: none;
  z-index: 9999;
  animation: tooltip-fade-in 0.2s ease-out forwards;
}

.dark .info-tooltip-content {
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.6);
}

@keyframes tooltip-fade-in {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

/* 拉動條樣式 (Input Range) */
input[type="range"] {
  -webkit-appearance: none;
  appearance: none;
  width: 100%;
  height: 6px;
  border-radius: 5px;
  background: rgb(var(--border));
  outline: none;
  cursor: pointer;
}

/* Webkit 瀏覽器 (Chrome, Safari, Edge) - 軌道 */
input[type="range"]::-webkit-slider-runnable-track {
  width: 100%;
  height: 6px;
  border-radius: 5px;
  background: rgb(var(--border));
  cursor: pointer;
}

/* Webkit 瀏覽器 (Chrome, Safari, Edge) - 滑塊 */
input[type="range"]::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 16px;
  height: 16px;
  border-radius: 50%;
  background: rgb(var(--accent));
  cursor: pointer;
  margin-top: -5px;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

input[type="range"]::-webkit-slider-thumb:hover {
  transform: scale(1.15);
  box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
}

input[type="range"]::-webkit-slider-thumb:active {
  transform: scale(1.05);
}

/* Firefox - 軌道 */
input[type="range"]::-moz-range-track {
  width: 100%;
  height: 6px;
  border-radius: 5px;
  background: rgb(var(--border));
  border: none;
  cursor: pointer;
}

/* Firefox - 滑塊 */
input[type="range"]::-moz-range-thumb {
  width: 16px;
  height: 16px;
  border-radius: 50%;
  background: rgb(var(--accent));
  cursor: pointer;
  border: none;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

input[type="range"]::-moz-range-thumb:hover {
  transform: scale(1.15);
  box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
}

input[type="range"]::-moz-range-thumb:active {
  transform: scale(1.05);
}

/* Firefox - 進度條 */
input[type="range"]::-moz-range-progress {
  background-color: rgb(var(--accent));
}

/* Search highlight styles */
.search-result {
  background-color: rgba(255, 237, 74, 0.4);
  transition: background-color 0.2s ease;
}

.dark .search-result {
  background-color: rgba(255, 237, 74, 0.25);
}

.search-result-current {
  background-color: rgba(255, 152, 0, 0.6);
  transition: background-color 0.2s ease;
  box-shadow: 0 0 0 2px rgba(255, 152, 0, 0.3);
}

.dark .search-result-current {
  background-color: rgba(255, 152, 0, 0.4);
  box-shadow: 0 0 0 2px rgba(255, 152, 0, 0.2);
}
