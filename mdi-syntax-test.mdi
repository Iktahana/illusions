# MDI 構文テスト文書

この文書はMDI 1.0仕様で定義されているすべての構文機能をテストするためのものです。

## 1. ルビのテスト

### 基本的な例
{幻影|げんえい}が{見|み}えた。
{虚構|きょこう}の{世界|せかい}を{彷徨|さまよ}う。

### 組み合わせルビ
{蜃気楼|しんきろう}のような{景色|けしき}。
{現実|げんじつ}と{幻想|げんそう}の{境界|きょうかい}が{曖昧|あいまい}になる。

### 送り仮名
{消|き}えていく{記憶|きおく}。
{儚|はかな}い{夢|ゆめ}。

---

## 2. 縦中横のテスト

### 数字のテスト
第^7^の{幻覚|げんかく}
^3^度目の{邂逅|かいこう}
{時計|とけい}は^12^{時|じ}を{指|さ}している。

### 記号のテスト
^!?^と{困惑|こんわく}した。
^……^{虚空|こくう}を{見|み}つめる。
^──^{静寂|せいじゃく}が{支配|しはい}する。

### 英字
^NO^という{文字|もじ}が{浮|う}かぶ。
^VOID^の{領域|りょういき}。

---

## 3. 改行抑止のテスト

### 場所や概念
[[no-break:鏡の国]]の{向|む}こう{側|がわ}へ。
[[no-break:夢幻の森]]を{抜|ぬ}けて。

### 固有名詞
彼女は[[no-break:虚無への招待]]という{本|ほん}を{読|よ}んでいた。
[[no-break:幻想曲第三番]]が{静|しず}かに{流|なが}れる。

### 複合語
[[no-break:認識の歪み]]が{生|しょう}じている。
[[no-break:存在の揺らぎ]]を{感|かん}じる。

---

## 4. 字間調整のテスト

### 負の間隔（詰める）
それは[[kern:-0.1em:確実]]に{幻|まぼろし}だった。
[[kern:-0.15em:虚像]]が{目|め}の{前|まえ}に{現|あらわ}れる。
[[kern:-0.05em:静寂]]の{中|なか}で。

### 正の間隔（広げる）
[[kern:+0.3em:虚無]]が{広|ひろ}がる。
[[kern:+0.2em:幻想]]に{浸|ひた}る。
[[kern:+0.1em:空白]]だけが{残|のこ}る。

### ゼロ間隔（通常）
[[kern:0em:通常]]の{文字間隔|もじかんかく}。

---

## 5. 複合テスト

### 混合使用
{鏡|かがみ}の{中|なか}の第^7^{層|そう}は[[no-break:虚構の都市]]で[[kern:-0.1em:展開]]される。

^3^{回目|かいめ}の{夢|ゆめ}で、{幻影|げんえい}が[[no-break:虚無の図書館]]に[[kern:-0.05em:現]]れた。

### 複雑な文
[[kern:+0.2em:彼女]]は^17^{歳|さい}で、[[no-break:幻想芸術学院]]に{入学|にゅうがく}し、{虚構|きょこう}の{世界|せかい}を{学|まな}んでいる。第^5^{章|しょう}では、[[kern:-0.1em:確実]]な[[no-break:証拠]]が{提示|ていじ}される——それは{現実|げんじつ}が{幻|まぼろし}であるという{証明|しょうめい}だった。

---

## 6. 境界ケーステスト

### 空内容のテスト
{|} （空のルビ）
^^ （空のTCY）
[[no-break:]] （空の改行抑止）
[[kern:0em:]] （空の字間調整）

### 特殊文字
{蜃気楼タワー|しんきろうタワー}
^7.5^
[[no-break:UTF-8]]
[[kern:-0.1em:naïve]]

### 長い内容
{非常に長い親文字がここに入ります実在と虚構の境界が曖昧になっていく|ながいルビのてすと}
^0123456789^
[[no-break:これは非常に長い改行抑止のテキストです。どこまで長くなるか試してみましょう。現実と幻想が混ざり合う世界。]]
[[kern:-0.2em:長い字間調整テキストのテストです虚構の世界へようこそ]]

---

## 7. 無効な構文のテスト（原文のまま保持されるべき）

### 無効なKerning値
[[kern:invalid:text]] （フォーマットエラー）
[[kern:1px:text]] （単位エラー）
[[kern:1em + 2px:text]] （複雑な式）

### 不完全な構文
{閉じていないルビ|
^閉じていないTCY
[[no-break:閉じていない

---

## テストの説明

### 期待される動作

1. **Ruby**: `<ruby><rb>親文字</rb><rt>ルビ</rt></ruby>` としてレンダリングされる
2. **TCY**: `<span class="tcy">内容</span>` としてレンダリングされ、縦書きモードで横に表示される
3. **No-break**: `<span class="mdi-nobr">内容</span>` としてレンダリングされ、改行を防ぐ
4. **Kerning**: `<span class="mdi-kern" style="--mdi-kern:量;">内容</span>` としてレンダリングされる

### 視覚確認項目

- [ ] Rubyのrtタグのフォントサイズが基本文字の0.5倍である
- [ ] TCYが縦書きモードで正しく横向きに表示される
- [ ] No-break内容が途中で改行されない
- [ ] Kerningの字間調整効果が明確に見える
- [ ] 無効な構文は原文のまま保持される

### Markdownラウンドトリップテスト

1. エディタでこの文書を開く
2. 任意の内容を編集する
3. 保存する
4. 再度開く
5. すべての構文マークが変更されていないことを確認する

---

テスト完了日: 2026-01-29
MDI仕様バージョン: 1.0 Draft
